<!--
 * @Author: 张宁
 * @Date: 2020-08-02 11:00
 * @LastEditors: Please set LastEditors
 * @LastEditTime: 2020-08-06 21:26:41
 * @Description: 页面快速生成
-->

# sofa-cosmos

> 张宁、魏斌 @2020-08-02

## 技术选型和整体实现

- 技术实现：基于node、react-dnd、plop实现了页面快速生成的工具
- 目的是：提高开发效率、约束开发规范
- 成果：快速生成页面的代码、直接预览页面、页面的增删管理、支持自定义修改模板
- 优势：方便升级迭代、快速生成页面、可二次开发

## 为什么要做快速生成工具

提高开发效率：对于中后台的管理页，相似度较高，通过工具生成页面，其中若对于逻辑复杂的页面，也可基于基础页面做二次开发，大大提高开发效率。
约束开发规范：一个管理页的副处理较多，开发者通过工具生成，不必关心这些细节的副处理；
交互统一和代码规范：抹平不同开发者的差异，提高代码的可维护性；

简单的新增交互、快速预览页面、直接生成代码，这些都是为了提高工具易用性，使工具被大家真正的使用，并进一步优化

## cosmos使用说明

- 执行：npm run start
- 在sofa-cosmos页中操作新增页面，输入表单，拖拽组件，点击生成按钮。
- 在sofa-cosmos页中操作移除页面，选择需要移除的page，点击移除按钮。

## 使用自定义模板
- 执行：npm run sofa-cosmos-template，生成模板，修改


## 基础包sofa-comos使用

### 命令1：sofa-cosmos serve <port> [templatePath]
- 启动sofa-cosmos服务
- 其中template为模板路径，缺省代表使用包的默认模板

### 命令2：sofa-cosmos clone destPath
- clone默认模板到本地，自定义修改
- 其中destPath为模板的存放路径

### 新增页面说明
1，新增-基本信息
| 字段     |   说明   | 
| -----------| --------------|
| 代码生成方式   |  配置生成（或json生成）  | 
| 页面名称  | 页面中文名称     | 
| 页面key  | 页面在项目中的主key    |
| 模板选择  | 筛选-表格-弹窗页    |
| 代码生成模式  | 页面模式（或组件模式）    |

2、配置生成-拖拽组件元素
- 在左侧配置页面相关的 字段 和 枚举值
- 将字段拖拽到右侧布局中，每个字段有默认组件，也可以从左侧拖拽组件到字段上
| 布局     |   说明   | 
| -----------| --------------|
| 查询表单   |  查询面板的form项  | 
| 操作按钮  | 功能按钮，如查询、重置、新建     | 
| 数据表格  |  table列  |
| 增改弹窗  |  增改弹窗的form项   |


## 设计说明
- 监听3000端口，前端与dev-server交互后基于plop生成代码，目录:internals/server/*
- 生成代码过程打印日志，可查看新增或修改的文件，或跟踪报错

### 接口说明
| interface     | method     | request params      | Remark     |
| -----------| --------------| --------------| --------------|
| /cosmos/generateCode   | POST   | json | 根据请参生成页面代码 |
| /cosmos/getPageList   | GET     | - | 获取本地所有业务页面 |
| /cosmos/deletePage   | GET    | { key } | 删除某页面 |
